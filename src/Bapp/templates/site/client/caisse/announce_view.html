{% extends "site/client/base_client.html" %}
{% load static %}

{% block title %}<title>Annonces</title>{% endblock %}

{% block extra_css %}<link href="{% static 'css/client/caisse/announce.css'%}" rel="stylesheet" type="text/css">{% endblock %}

{% block content %}
<style>
  .pagination{background-color:#0d6efd !important; border: 2px solid #0d6efd !important; /* Force la bordure sur le lien */}
  ul li{margin-bottom:inherit;}
</style>
<div class="wrap">
    <header class="site" role="banner">
        <div>
            <h1>Articles</h1>
            <p class="subtitle">Actualités et contenus, adaptés à tous les écrans.</p>
        </div>
    </header>

    {% if articles %}
        <section class="articles-grid" aria-label="Liste des articles">
            {% for article in articles %}
                <article class="card" itemscope itemtype="https://schema.org/Article">
                    {% if article.image %}
                        <div class="media">
                            <img src="{{ article.image.url }}"
                                 alt="{{ article.title }}"
                                 loading="lazy"
                                 decoding="async"
                                 itemprop="image" />
                        </div>
                    {% endif %}

                    <div class="content">
                        <h2 itemprop="headline">
                            {{ article.title }}
                        </h2>

                        <div class="meta">
                            {% if article.author %}
                                <span class="badge" title="Auteur">Par {{ article.author }}</span>
                            {% endif %}
                            {% if article.published_at %}
                                <time datetime="{{ article.published_at|date:'d/m/Y' }}" itemprop="datePublished">
                                    Publié le {{ article.published_at }}
                                </time>
                            {% endif %}
                        </div>

                        <p class="excerpt" itemprop="description">
                            {{ article.content|striptags|truncatewords:40 }}
                        </p>

                        <div class="actions">
                            {% if article.extra_links %}
                                <a class="button"
                                   href="{{ article.extra_links }}"
                                   target="_blank"
                                   rel="noopener nofollow external"
                                   aria-label="Lire l’article « {{ article.title }} » (ouvre un nouvel onglet)">
                                   Lire l’article
                                </a>
                            {% else %}
                                <span class="ghost" aria-disabled="true">Lien indisponible</span>
                            {% endif %}
                        </div>
                    </div>
                </article>
            {% endfor %}
    {% endif %}

     </section>
        {% if is_paginated %}
           {% if page_obj.has_other_pages %}
               <nav class="mt-4 d-flex justify-content-center">
                   <ul class="pagination shadow-sm rounded-pill overflow-hidden">
                       {% if page_obj.has_previous %}
                           <li class="page-item"><a class="page-link border-0" href="?page={{ page_obj.previous_page_number }}"><i class="fas fa-chevron-left"></i></a></li>
                       {% endif %}

                       <li class="page-item active"><span class="page-link border-0 px-4">Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}</span></li>

                       {% if page_obj.has_next %}
                           <li class="page-item"><a class="page-link border-0" href="?page={{ page_obj.next_page_number }}"><i class="fas fa-chevron-right"></i></a></li>
                       {% endif %}
                   </ul>
               </nav>
            {% endif %}
     {% else %}
         <!-- ETAT VIDE -->
         <div class="coti-empty" role="status">
             <p><i class="fa-regular fa-folder-open fa-3x" aria-hidden="true"></i></p>
             <p>Aucune donnée disponible pour le moment.</p>
         </div>
     {% endif %}
</div>
{% endblock %}