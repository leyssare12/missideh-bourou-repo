{% extends "site/client/base_client.html" %}


{% load static %}
{% block title %}<title>Home users</title>{% endblock %}

{% block extra_css%}<link href="{% static 'css/client/missidhe_bourou_members.css'%}" rel="stylesheet" type="text/css">{% endblock %}


{% block content %}
<div id="app-config"
     data-search-url="{% url 'Bapp:member_search' %}"
     data-list-url="{% url 'Bapp:missideh_bourou_members' %}"
     hidden>
</div>
<div class="table-container">
    <div class="panel">
      <div class="panel-header">
        <h1 class="title">Liste de membres Missideh Bourou</h1>
        <label class="search searchTerm">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="#9ca3af" aria-hidden="true">
            <path d="M21 21l-4.3-4.3m1.8-5.2a7 7 0 11-14 0 7 7 0 0114 0z" stroke="#9ca3af" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input id="filter" type="search" placeholder="Rechercher…">

        </label>
        <div id="searchResults" class="search-results"></div>
      </div>

      <div class="table-wrapper">
        <table aria-describedby="hint">
          <thead>
            <tr>
              <th scope="col">Prénom:</th>
              <th scope="col">Quartier:</th>
              <th scope="col">Pays:</th>
              <th scope="col">Téléphone:</th>
              <th scope="col">Email:</th>
            </tr>
          </thead>
          <tbody id="table-body">
            {% if page_obj and page_obj.object_list %}
              {% for m in page_obj.object_list %}
                <tr class="{% if forloop.counter0|divisibleby:2 %}ligne_paire{% else %}ligne_impaire{% endif %}">
                  <td data-label="Prénoms">{{ m.prenoms }}</td>
                  <td data-label="Quartier">{{ m.quartier }}</td>
                  <td data-label="Pays"><span class="tag">{{ m.pays }}</span></td>
                    <td data-label="Telephone">
                      {% if m.telephone %}
                        <span class="phone-link-wrapper">
                          <i class="fas fa-phone-alt" style="color:#3b82f6;"></i>
                          <a href="tel:{{ m.telephone }}" class="phone-link">{{ m.telephone }}</a>
                        </span>
                      {% else %}-{% endif %}
                    </td>
                  <td data-label="Email">
                    {% if m.email %}
                      <a href="mailto:{{ m.email }}" style="color:#93c5fd;text-decoration:none;">{{ m.email }}</a>
                    {% else %}-{% endif %}
                  </td>
                </tr>
              {% endfor %}
            {% else %}
              <tr><td colspan="5" style="text-align:center;color:#a3a3a3;padding:18px;">Aucun membre trouvé.</td></tr>
            {% endif %}
          </tbody>
        </table>
      </div>

      {% if is_paginated %}
        <nav class="pagination" role="navigation" aria-label="Pagination">
          {% if page_obj.has_previous %}
            <a href="?page=1" aria-label="Première page">«</a>
            <a href="?page={{ page_obj.previous_page_number }}" aria-label="Page précédente">‹</a>
          {% else %}
            <span class="disabled" aria-disabled="true">«</span>
            <span class="disabled" aria-disabled="true">‹</span>
          {% endif %}

          {% with start=page_obj.number|add:"-2" end=page_obj.number|add:"2" %}
            {% for num in page_obj.paginator.page_range %}
              {% if num >= start and num <= end %}
                {% if num == page_obj.number %}
                  <span class="current" aria-current="page">{{ num }}</span>
                {% else %}
                  <a href="?page={{ num }}">{{ num }}</a>
                {% endif %}
              {% endif %}
            {% endfor %}
          {% endwith %}

          {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" aria-label="Page suivante">›</a>
            <a href="?page={{ page_obj.paginator.num_pages }}" aria-label="Dernière page">»</a>
          {% else %}
            <span class="disabled" aria-disabled="true">›</span>
            <span class="disabled" aria-disabled="true">»</span>
          {% endif %}
        </nav>
        <p style="text-align:center;color:#a3a3a3;font-size:.9rem;">
          Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}
        </p>
      {% endif %}
      <p id="hint" class="sr-only" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;">
        Tableau des membres responsive; sur mobile, chaque ligne devient une carte avec labels.
      </p>
    </div>
  </div>

  <script>
    // Filtre client léger (optionnel)
    const filter = document.getElementById('filter');
    const tbody = document.getElementById('table-body');
    filter?.addEventListener('input', () => {
      const q = filter.value.toLowerCase();
      let visible = 0;
      Array.from(tbody.children).forEach(tr => {
        const show = tr.textContent.toLowerCase().includes(q);
        tr.style.display = show ? '' : 'none';
        if (show) visible++;
      });
    });
  </script>

{% endblock %}
{% block scripts %}<script src="{% static 'js/client/member_search.js'%}"></script> {% endblock %}